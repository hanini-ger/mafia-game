<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shadows & Lies | Mafia Game</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/lucide@latest"></script>
  <script type="module" src="client.js" defer></script>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: radial-gradient(ellipse at top, #0b0b0f 0%, #000 100%);
      color: #f1f1f1;
      font-family: "Poppins", sans-serif;
    }
    .glass {
      background: rgba(30, 30, 30, 0.6);
      border: 1px solid rgba(255, 215, 0, 0.15);
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.08);
      backdrop-filter: blur(20px);
    }
    .gold-glow {
      color: #ffd85b;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
    }
    .btn-gold {
      background: transparent;
      border: 1px solid rgba(255, 215, 0, 0.4);
      color: #ffd85b;
      font-weight: 600;
      transition: 0.3s;
    }
    .btn-gold:hover {
      background: rgba(255, 215, 0, 0.1);
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }
  </style>
</head>

<body class="flex items-center justify-center min-h-screen">

  <!-- Landing Screen -->
  <div id="landing-screen" class="glass p-10 rounded-2xl w-[380px] text-center hidden">
    <h1 class="text-4xl font-extrabold gold-glow mb-2">SHADOWS & LIES</h1>
    <p class="text-gray-400 mb-6 italic">A Game of Wits and Betrayal</p>

    <input id="player-name" type="text" placeholder="Enter your name" 
           class="w-full p-2 rounded bg-transparent border border-gray-500 mb-3 text-center text-white" />

    <input id="room-code" type="text" placeholder="Room Code (Optional)" 
           class="w-full p-2 rounded bg-transparent border border-gray-500 mb-5 text-center text-white" />

    <div class="flex justify-center gap-4">
      <button id="host-btn" class="btn-gold px-4 py-2 rounded-md" onclick="handleLobbyAction('create')" disabled>
        <i data-lucide="crown"></i> Host Game
      </button>
      <button id="join-btn" class="btn-gold px-4 py-2 rounded-md" onclick="handleLobbyAction('join')" disabled>
        <i data-lucide="key"></i> Join Game
      </button>
    </div>
  </div>

  <!-- Lobby Screen -->
  <div id="lobby-screen" class="glass p-8 rounded-2xl w-[500px] text-center hidden">
    <h2 class="text-2xl font-bold gold-glow mb-3">Game Lobby</h2>
    <p id="room-display" class="text-gray-400 mb-4">Room Code: ...</p>
    <div id="player-list" class="bg-black/30 p-3 rounded-lg h-[160px] overflow-y-auto mb-4 text-sm"></div>

    <button id="start-game-btn" class="btn-gold px-4 py-2 rounded-md">
      <i data-lucide="play"></i> Start Game
    </button>
  </div>

  <!-- Game Screen -->
  <div id="game-screen" class="hidden flex flex-col items-center text-center w-full max-w-2xl glass p-10 rounded-2xl">
    <h2 class="text-3xl font-bold gold-glow mb-4">Game in Progress</h2>
    <p id="phase-display" class="text-gray-300 mb-2 italic">Waiting for others...</p>

    <div id="player-status" class="grid grid-cols-3 gap-2 w-full mb-5"></div>

    <div id="chat-box" class="bg-black/30 w-full p-4 rounded-lg mb-4 h-[200px] overflow-y-auto text-left text-sm"></div>
    <div class="flex w-full gap-2">
      <input id="chat-input" type="text" placeholder="Type a message..." 
             class="flex-grow p-2 rounded bg-transparent border border-gray-600 text-white" />
      <button id="send-chat-btn" class="btn-gold px-4 py-2 rounded-md"><i data-lucide="send"></i></button>
    </div>
  </div>

  <!-- Loading Screen -->
  <div id="loading-screen" class="absolute inset-0 flex flex-col items-center justify-center bg-black text-gray-400">
    <div class="animate-pulse text-lg">Connecting to Firebase...</div>
  </div>

  <script>
    // Disable until Firebase auth ready
    document.querySelectorAll('#host-btn, #join-btn').forEach(b => b.disabled = true);

    document.addEventListener('DOMContentLoaded', () => {
      lucide.createIcons();
      window.addEventListener('firebaseReady', () => {
        document.querySelectorAll('#host-btn, #join-btn').forEach(b => b.disabled = false);
        document.getElementById('loading-screen').classList.add('hidden');
        document.getElementById('landing-screen').classList.remove('hidden');
      });
    });
  </script>
</body>
</html>
